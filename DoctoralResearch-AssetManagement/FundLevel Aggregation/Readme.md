# Aggregate Share Class Information at Portfolio Level (Fund Unit)

## Overview

In this repository, the `AggregatingShares.R` script is provided to aggregate information reported at the share class level by CRSP into portfolio-level data.

## Aggregation Methodology

- **Data at Share Class Level**: Certain variables such as net Return (mret), cash holdings (per_cash), expense ratio (exp_ratio), and management fee (mgmt_fee) are reported at the share class level by CRSP. While cash holdings generally represent the entire portfolio, expense ratio and management fee are more specific to the portfolio level.

- **Addressing Inconsistencies**: Occasionally, some share classes within a portfolio may not report specific information. The script calculates a value-weighted average to accurately aggregate data at the portfolio level. This approach considers only those share classes with reported data and weighs them based on their proportion of the total assets within the portfolio.

## Data Sources and Structure

- **CRSP Files**: The required data is extracted from CRSP files named `MonthlyReturns.dta` and `MonthlySummary.dta`. These files present information at the share class level, which is then aggregated to the portfolio level using the script.

- **Integration with Mapping File**: To enhance data tracking and enable connections with other data structures like Morningstar and Thomson Reuters, the script incorporates the mapping file generated by `MonthFundIdMAP.R`. Although the aggregation can be performed without this mapping, it provides a structured approach to aligning portfolio-level information across different sources. You can find the mapping script [here](https://github.com/carr8824/Data-Cleaning/tree/main/DoctoralResearch-AssetManagement/Data%20Matching).

## Important Note on Data Reporting

- **Non-Uniform Reporting**: It's important to note that data reporting by sources like CRSP is not uniform. For example, a fund may have varying information available across different time periods or share classes. The aggregation script considers these discrepancies, ensuring a more accurate and representative portfolio-level dataset.

The `AggregatingShares.R` script thus plays a crucial role in transforming share class-specific data into comprehensive portfolio-level information, facilitating more accurate analysis and research in mutual fund performance and characteristics.
